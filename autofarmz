getgenv().mainName = getgenv().mainName or ""

local Players = game:GetService("Players")
local VirtualUser = game:GetService("VirtualUser")
local LocalPlayer = Players.LocalPlayer

local MAIN_CFRAME = CFrame.new(1063,406,23006)
local ALT_CFRAME  = CFrame.new(1063,406,22996)

local CYCLE_TIME = 6

LocalPlayer.Idled:Connect(function()
    VirtualUser:CaptureController()
    VirtualUser:ClickButton2(Vector2.new())
end)

task.spawn(function()
    while task.wait(0.25) do
        local c = LocalPlayer.Character
        if c then
            local comm = c:FindFirstChild("Communicate")
            if comm then
                pcall(function()
                    comm:FireServer({Goal="Emote Spin"})
                end)
            end
        end
    end
end)

local function char()
    return LocalPlayer.Character or LocalPlayer.CharacterAdded:Wait()
end

local function root()
    return char():WaitForChild("HumanoidRootPart")
end

local function tp(cf)
    root().CFrame = cf
end

local function reset()
    char():WaitForChild("Humanoid").Health = 0
end

local isMain = LocalPlayer.Name == getgenv().mainName

LocalPlayer.CharacterAdded:Connect(function()
    task.wait()
    tp(isMain and MAIN_CFRAME or ALT_CFRAME)
end)

task.spawn(function()
    while true do
        if isMain then
            tp(MAIN_CFRAME)
            task.wait(1)

            local t = char():FindFirstChild("Scatter") or LocalPlayer.Backpack:FindFirstChild("Scatter")
            if t then
                t.Parent = char()
                task.wait(0.15)
                t:Activate()
                task.wait(3)
            end

            reset()
        else
            tp(ALT_CFRAME)
            task.wait(1)
            reset()
        end

        LocalPlayer.CharacterAdded:Wait()
        tp(isMain and MAIN_CFRAME or ALT_CFRAME)
        task.wait(CYCLE_TIME)
    end
end)
